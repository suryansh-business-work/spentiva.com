---
const navItems = [
  { name: "Home", href: "/", icon: "fas fa-home" },
  { name: "About", href: "/about", icon: "fas fa-info-circle" },
  { name: "Use Cases", href: "/use-cases", icon: "fas fa-users" },
  { name: "Pricing", href: "/pricing", icon: "fas fa-tag" },
  { name: "Blog", href: "/blog", icon: "fas fa-newspaper" },
  { name: "Contact", href: "/contact", icon: "fas fa-envelope" },
];

const features = [
  { name: "Upcoming Features", href: "/upcoming-features", icon: "fas fa-rocket", badge: "New" },
];

const currentPath = Astro.url.pathname;
---

<header
  class="fixed top-0 left-0 right-0 z-50 bg-white/95 backdrop-blur-xl border-b border-gray-100 transition-all duration-300 h-16 shadow-sm"
  id="mobile-header"
>
  <div class="container mx-auto px-4 h-full flex items-center justify-between">
    <!-- Logo -->
    <a
      href="/"
      class="flex items-center space-x-2.5 group cursor-pointer"
      aria-label="Spentiva Home"
    >
      <div class="w-9 h-9 flex items-center justify-center bg-gradient-to-br from-primary-400 to-primary-600 rounded-xl shadow-lg shadow-primary-500/25">
        <img
          src="/logo.svg"
          alt="Spentiva Logo"
          class="w-6 h-6"
          width="24"
          height="24"
        />
      </div>
      <div class="flex flex-col">
        <span
          class="font-bold text-lg text-gray-900 tracking-tight leading-none"
          >Spentiva</span
        >
        <span
          class="text-[9px] tracking-widest text-primary-500 font-semibold uppercase leading-none mt-0.5"
          >By Exyconn</span
        >
      </div>
    </a>

    <!-- Mobile Menu Button -->
    <button
      id="mobile-menu-toggle"
      class="p-2 text-gray-600 hover:bg-primary-50 rounded-xl transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 relative w-11 h-11 flex items-center justify-center"
      aria-label="Toggle navigation menu"
      aria-expanded="false"
      aria-controls="mobile-menu-drawer"
    >
      <div
        class="cursor-pointer hamburger-icon w-6 h-5 relative flex flex-col justify-between"
      >
        <span
          class="w-full h-0.5 bg-gray-700 rounded-full transform transition-all duration-300 origin-left"
        ></span>
        <span
          class="w-4 h-0.5 bg-gray-700 rounded-full transform transition-all duration-300 opacity-100"
        ></span>
        <span
          class="w-full h-0.5 bg-gray-700 rounded-full transform transition-all duration-300 origin-left"
        ></span>
      </div>
    </button>
  </div>

  <!-- Mobile Navigation Drawer -->
  <div
    id="mobile-menu-drawer"
    class="fixed inset-x-0 top-16 bottom-0 bg-white/98 backdrop-blur-xl border-t border-gray-100 transform origin-top transition-all duration-300 ease-out opacity-0 translate-y-4 invisible overflow-y-auto"
  >
    <div class="container mx-auto px-4 py-6">
      <!-- Navigation Links -->
      <nav class="space-y-2 mb-6">
        {
          navItems.map((item, index) => (
            <a
              href={item.href}
              class={`nav-item flex items-center gap-4 px-4 py-3.5 rounded-2xl text-base font-medium transition-all duration-200 ${
                currentPath === item.href
                  ? "bg-gradient-to-r from-primary-500 to-primary-600 text-white shadow-lg shadow-primary-500/25"
                  : "text-gray-700 hover:bg-gray-50"
              }`}
              style={`animation-delay: ${index * 50}ms`}
            >
              <span class={`w-10 h-10 rounded-xl flex items-center justify-center ${
                currentPath === item.href
                  ? "bg-white/20"
                  : "bg-gray-100"
              }`}>
                <i class={`${item.icon} ${currentPath === item.href ? "text-white" : "text-gray-500"}`}></i>
              </span>
              <span>{item.name}</span>
              {currentPath === item.href && (
                <i class="fas fa-check ml-auto text-white/80"></i>
              )}
            </a>
          ))
        }
      </nav>
      
      <!-- Features Section -->
      <div class="mb-6">
        <p class="text-xs font-semibold text-gray-400 uppercase tracking-wider px-4 mb-3">Features</p>
        {
          features.map((item) => (
            <a
              href={item.href}
              class="flex items-center gap-4 px-4 py-3.5 rounded-2xl text-base font-medium text-gray-700 hover:bg-gray-50 transition-all duration-200"
            >
              <span class="w-10 h-10 bg-gradient-to-br from-purple-100 to-pink-100 rounded-xl flex items-center justify-center">
                <i class={`${item.icon} text-purple-500`}></i>
              </span>
              <span>{item.name}</span>
              {item.badge && (
                <span class="ml-auto px-2 py-0.5 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs font-bold rounded-full">
                  {item.badge}
                </span>
              )}
            </a>
          ))
        }
      </div>

      <!-- Divider -->
      <div class="border-t border-gray-100 my-6"></div>

      <!-- CTA Buttons -->
      <div class="space-y-3">
        <a
          href="https://auth.spentiva.com/signup"
          class="flex items-center justify-center gap-2 w-full px-6 py-4 bg-gradient-to-r from-primary-500 to-primary-600 text-white font-semibold rounded-2xl hover:from-primary-600 hover:to-primary-700 shadow-xl shadow-primary-500/25 transition-all duration-200"
        >
          <i class="fas fa-rocket"></i>
          Start Free Trial
        </a>
        <a
          href="https://auth.spentiva.com/"
          class="flex items-center justify-center gap-2 w-full px-6 py-4 bg-gray-100 text-gray-700 font-semibold rounded-2xl hover:bg-gray-200 transition-all duration-200"
        >
          <i class="fas fa-sign-in-alt"></i>
          Log in
        </a>
      </div>
      
      <!-- App Download Buttons -->
      <div class="mt-8 p-4 bg-gradient-to-r from-gray-50 to-gray-100 rounded-2xl">
        <p class="text-sm font-semibold text-gray-700 mb-3 text-center">Get the App</p>
        <div class="grid grid-cols-2 gap-3">
          <a href="#" class="flex items-center justify-center gap-2 px-4 py-3 bg-black text-white rounded-xl text-sm font-medium hover:bg-gray-800 transition-colors">
            <i class="fab fa-apple text-lg"></i>
            <span>App Store</span>
          </a>
          <a href="#" class="flex items-center justify-center gap-2 px-4 py-3 bg-black text-white rounded-xl text-sm font-medium hover:bg-gray-800 transition-colors">
            <i class="fab fa-google-play text-lg"></i>
            <span>Play Store</span>
          </a>
        </div>
      </div>

      <!-- Social Links -->
      <div class="mt-6 flex items-center justify-center gap-4">
        <a href="#" class="w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center text-gray-500 hover:bg-primary-100 hover:text-primary-500 transition-colors">
          <i class="fab fa-twitter"></i>
        </a>
        <a href="#" class="w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center text-gray-500 hover:bg-primary-100 hover:text-primary-500 transition-colors">
          <i class="fab fa-instagram"></i>
        </a>
        <a href="#" class="w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center text-gray-500 hover:bg-primary-100 hover:text-primary-500 transition-colors">
          <i class="fab fa-linkedin-in"></i>
        </a>
        <a href="#" class="w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center text-gray-500 hover:bg-primary-100 hover:text-primary-500 transition-colors">
          <i class="fab fa-youtube"></i>
        </a>
      </div>
      
      <!-- Version Info -->
      <p class="mt-6 text-center text-xs text-gray-400">Spentiva v2.0 • © 2024 Exyconn</p>
    </div>
  </div>
</header>

<style>
  /* Hamburger Animation Classes */
  .menu-open .hamburger-icon span:nth-child(1) {
    transform: rotate(45deg) translateY(0.5px);
    width: 100%;
  }
  .menu-open .hamburger-icon span:nth-child(2) {
    opacity: 0;
    transform: translateX(-10px);
  }
  .menu-open .hamburger-icon span:nth-child(3) {
    transform: rotate(-45deg) translateY(-0.5px);
    width: 100%;
  }
  
  /* Menu Open State - Drawer */
  .menu-visible {
    opacity: 1 !important;
    transform: translateY(0) !important;
    visibility: visible !important;
  }
  
  /* Nav Item Animation */
  .nav-item {
    opacity: 0;
    transform: translateX(-20px);
    transition: opacity 0.3s ease, transform 0.3s ease, background-color 0.2s ease;
  }
  
  .menu-visible .nav-item {
    opacity: 1;
    transform: translateX(0);
  }
</style>

<script>
  function initMobileMenu() {
    const toggleBtn = document.getElementById("mobile-menu-toggle");
    const drawer = document.getElementById("mobile-menu-drawer");

    if (!toggleBtn || !drawer) return;

    let isOpen = false;

    function setMenuState(open: boolean) {
      isOpen = open;
      toggleBtn?.setAttribute("aria-expanded", open.toString());

      if (open) {
        drawer?.classList.add("menu-visible");
        toggleBtn?.classList.add("menu-open");
        document.body.style.overflow = "hidden";
      } else {
        drawer?.classList.remove("menu-visible");
        toggleBtn?.classList.remove("menu-open");
        document.body.style.overflow = "";
      }
    }

    // Clean up old listeners
    const newBtn = toggleBtn.cloneNode(true);
    toggleBtn.parentNode?.replaceChild(newBtn, toggleBtn);

    const activeBtn = document.getElementById("mobile-menu-toggle");

    activeBtn?.addEventListener("click", (e) => {
      e.stopPropagation();
      setMenuState(!isOpen);
    });

    document.addEventListener("click", (e) => {
      if (
        isOpen &&
        drawer &&
        activeBtn &&
        !drawer.contains(e.target as Node) &&
        !activeBtn.contains(e.target as Node)
      ) {
        setMenuState(false);
      }
    });
    
    // Close on nav link click
    const navLinks = drawer.querySelectorAll("a");
    navLinks.forEach(link => {
      link.addEventListener("click", () => {
        setMenuState(false);
      });
    });
  }

  initMobileMenu();
  document.addEventListener("astro:page-load", initMobileMenu);
</script>
